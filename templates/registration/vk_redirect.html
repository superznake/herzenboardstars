{% extends "base.html" %}

{% block content %}
<script type="text/javascript">
  // Автоматически отправляем код через POST
  window.onload = function() {
    const form = document.createElement('form');
    form.method = 'POST';
    form.action = '/oauth/complete/vk-oauth2/';

    const codeInput = document.createElement('input');
    codeInput.type = 'hidden';
    codeInput.name = 'code';
    codeInput.value = '{{ code }}';
    form.appendChild(codeInput);

    const csrfInput = document.createElement('input');
    csrfInput.type = 'hidden';
    csrfInput.name = 'csrfmiddlewaretoken';
    csrfInput.value = '{{ csrf_token }}';
    form.appendChild(csrfInput);

    document.body.appendChild(form);
    form.submit();
  };
</script>
<p>Обработка авторизации...</p>
{% endblock %}

